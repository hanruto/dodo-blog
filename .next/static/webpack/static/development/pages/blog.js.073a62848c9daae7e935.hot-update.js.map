{"version":3,"file":"static/webpack/static/development/pages/blog.js.073a62848c9daae7e935.hot-update.js","sources":["webpack:///./pages/blog/index.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { connect } from 'react-redux'\nimport dayjs from 'dayjs'\nimport Head from 'next/head'\nimport Logo from '../../components/Logo'\nimport AnimateQueue from '../../components/AnimateQueue'\nimport CommentList from '../../components/CommentList'\nimport Footer from '../../components/Footer'\nimport { track } from '../../utils/common'\nimport store from '../../store'\nimport './index.scss'\n\ninterface Props {\n  blog?: {\n    title: string\n    _id: string\n    created: string\n    content: string\n  }\n  comments?: { total: number; list: [] }\n  getComments?: Function\n  commentBlog?: Function\n}\nfunction BlogDetailPage(props: Props) {\n  const [comment, setComment] = useState('')\n  const [nickname, setNickname] = useState('')\n  const { getComments, commentBlog, blog, comments } = props\n\n  useEffect(() => {\n    if (blog && blog._id) {\n      getComments({ blogId: blog._id })\n      track('enter-blog-detail', 'route-change', { id: blog._id })\n    }\n  }, [])\n\n  const handleCommentSubmit = async e => {\n    e.preventDefault()\n\n    const info = {\n      content: comment,\n      type: 1,\n      nickname: nickname || '不愿意透漏姓名的热心网友',\n      blogId: blog._id,\n    }\n\n    setComment('')\n    commentBlog(info)\n  }\n\n  const handleCommentChange = e => {\n    setComment(e.target.value)\n  }\n\n  const handleNicknameChange = e => {\n    setNickname(e.target.value)\n  }\n\n  return (\n    <div className=\"blog-detail-page page-common-container\">\n      <Head>\n        <title>{`${blog ? blog.title : '博客找不到了'}-小寒的博客`}</title>\n      </Head>\n      <Logo />\n      {blog ? (\n        <AnimateQueue animate={true}>\n          <h2 className=\"page-common-blog-title\">{blog.title}</h2>\n          <div className=\"blog-created\">\n            {dayjs(blog.created).format('YYYY / MM / DD')}\n          </div>\n          <div\n            className=\"blog-content\"\n            dangerouslySetInnerHTML={{ __html: blog.content }}\n          />\n        </AnimateQueue>\n      ) : (\n        <div>博客找不到了</div>\n      )}\n\n      <div className=\"page-common-section-title\">写评论</div>\n      <div className=\"blog-comment-form\">\n        <input\n          maxLength={6}\n          type=\"text\"\n          className=\"blog-nickname-input\"\n          placeholder=\"名字或者昵称\"\n          onChange={handleNicknameChange}\n        />\n        <textarea\n          maxLength={150}\n          value={comment}\n          onChange={handleCommentChange}\n          className=\"blog-comment-input\"\n          placeholder=\"写点什么吧...\"\n        />\n        <button\n          className=\"blog-comment-submit-button\"\n          onClick={handleCommentSubmit}\n          disabled={!comment || !nickname}\n        >\n          评论\n        </button>\n      </div>\n\n      <div className=\"page-common-section-title comment-list-title\">\n        全部评论\n      </div>\n      <CommentList comments={comments.list} />\n\n      <Footer />\n    </div>\n  )\n}\n\nBlogDetailPage.getInitialProps = async ctx => {\n  const blogId = ctx.query.id\n  const { getBlog } = store.dispatch.blogModel\n  const blog = await getBlog(blogId)\n\n  return { blog }\n}\n\nconst mapState = state => ({ ...state.blogModel })\n\nconst mapDispatch = state => ({ ...state.blogModel })\n\nexport default connect(mapState, mapDispatch)(BlogDetailPage)\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAYA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAKA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AAJA;AAOA;AACA;AACA;AAZA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAMA;AAAA;AACA;AAAA;AACA;AAAA;AAIA;AACA;AAAA;AAAA;AAFA;AASA;AAAA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AALA;AAQA;AACA;AACA;AACA;AACA;AALA;AAQA;AACA;AACA;AAHA;AASA;AAAA;AAGA;AAAA;AAKA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AACA;AADA;AAGA;AAHA;AAKA;AAAA;AACA;AANA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAOA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;;;;A","sourceRoot":""}